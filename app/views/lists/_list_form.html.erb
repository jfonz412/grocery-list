<div class="new-list">
	<h2>New List</h2>

	<!-- New Items -->
	<%= render partial: 'shared/user_item_form' %>

	<!-- New Category -->	
	<%= render 'shared/new_category_form', locals: {category: @category} %>

	<%= form_for @list, url: list_path, html: {class: "form-signin"} do |f| %>
		<%= f.text_field :name, placeholder: "Name your list (optional)" %>
		<!-- Category -->
		<div class="categories">
			<% current_user.categories.each do |category| %>
				<h3 class="category">
				  <%= category.name %>
				</h3>
				<!-- User Items -->   
				<div class="dropdown-button" data-toggle="collapse" data-target="#<%= category.name_without_spaces %>">
					<span class="glyphicon glyphicon-chevron-down"></span>
				</div>
				<!-- Dropdown div -->
			 	<div id="<%= category.name_without_spaces %>" class="collapse">
			 		<div class="table-responsive">
			 			<!-- User Item table -->
				 		<% unless category.user_items[0].nil? %>
					 		<table class="items">
					 			<tr>
					 				<th>Add</th>
					 				<th>Name</th>
					 				<th>Price</th>
					 				<th>Qnty</th>
					 			</tr>
						   	<% category.user_items.each do |item| %>
							   	<%= f.fields_for l = @list.list_items.build, index: l.id do |list_item| %>
							   		<tr>
									   	<td><%= list_item.check_box :user_item_id, { checked: false }, item.id, nil %></td>
								    	<td><%= item.name %></td> 
								    	<td>$<%= number_with_precision(item.price, :precision => 2) %></td>
						  				<td><%= list_item.number_field :quantity, 
						  																			 	min: 1,
						  																			 	class: "num"%></td>
								    </tr>
							    <% end %>
						  	<% end %>
						  </table>
						<% end %>
						PLACEHOLDER, NO ITEMS IN THIS CATEGORY
					</div>
				</div>
				<div id='append<%= category.id %>'></div><!-- (new category goes here) -->
			<% end %> <!-- current_user.categories -->
			<br>
			<%= f.submit "Create List" %>
		</div>
	<% end %>
</div>
<!-- dropdown button script -->
<script>
  $(document).ready(function () {
      $('.data-toggle').collapse();
  });
</script>